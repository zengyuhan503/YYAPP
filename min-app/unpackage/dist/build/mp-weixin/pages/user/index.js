"use strict";const e=require("../../common/vendor.js"),a=require("../../utils/api/index.js");if(!Array){e.resolveComponent("uni-icons")()}Math||((()=>"../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+n)();const n=()=>"../../components/navs/index.js",t={__name:"index",setup(n){e.ref(-1),e.ref(-1),e.ref(0),e.ref([{}]),e.ref("default"),e.ref({}),e.ref(0);let t=e.ref({avatar:null,nickname:null,user_id:null,session_key:null,wx_openid:null}),o={};const i=e.ref(!1),r=e.ref(!1),s=()=>{e.index.makePhoneCall({phoneNumber:"15522756996"})},l=()=>{e.index.removeStorageSync("yy-token"),e.index.removeStorageSync("yy-userinfo"),i.value=!1},u=()=>{if(!c.value)return e.index.showToast({icon:"error",title:"请阅读并同意",duration:2e3}),!1},d=n=>{let r=n.detail;e.index.login({provider:"weixin",success:function(n){e.index.getUserInfo({provider:"weixin",success:function(s){let l={cloudID:s.cloudID,encryptedData:s.encryptedData,iv:s.iv,rawData:s.rawData,signature:s.signature,code:n.code};if(o=l,-1!=r.errMsg.indexOf("ok")){let n={code:r.code};(n=>{let r={cloudID:o.cloudID,code:o.code,encryptedData:o.encryptedData,rawData:o.rawData,iv:o.iv,signature:o.signature};a.GetUserInfo(r).then((a=>{let o={...a};t.value={avatar:o.avatar,nickname:o.nickname,user_id:o.user_id,session_key:o.session_key,wx_openid:o.wx_openid},e.index.setStorage({key:"yy-userinfo",data:JSON.stringify({avatar:o.avatar,nickname:o.nickname,user_id:o.user_id,session_key:o.session_key,wx_openid:o.wx_openid}),success:function(){console.log("success")}}),e.index.setStorageSync("yy-token",a.token.token),e.index.setStorage({key:"yy-is_login",data:!0}),i.value=!0,n()}))})((()=>{a.GetUserPhone(n).then((a=>{console.log(a),e.index.setStorageSync("yy-phone",a)})),f(),m()}))}}})}})};let c=e.ref(!1);const v=()=>{c.value=!c.value},p=()=>{e.index.navigateTo({url:"/pages/args/index1"})},g=()=>{e.index.navigateTo({url:"/pages/args/index2"})};e.onLoad((e=>{o=e})),e.onShow((()=>{m(),f()}));const y=()=>{e.wx$1.navigateTo({url:"/pages/editUser/index"})},f=()=>{a.GetServerUserInfo().then((e=>{t.value=e,t.value.avatar="https://www.yuyandental.com/"+e.avatar,i.value=!0}))},x=()=>{e.wx$1.navigateTo({url:"/pages/userAddress/index"})},_=()=>{e.wx$1.navigateTo({url:"/pages/about/desc"})},w=()=>{e.wx$1.navigateTo({url:"/pages/about/us"})};let k={0:[],2:[],4:[],all:[]};const m=()=>{a.GetOrderList({page:1,page_size:1e3,status:"all"}).then((e=>{let a=e.data;k[0]=a.filter((e=>0==e.status)),k[2]=a.filter((e=>2==e.status)),k[4]=a.filter((e=>4==e.status)),k.all=a}))},h=a=>{let n={0:"待付款",2:"待收货",4:"完成",all:"全部"};if(0==k[a].length)return e.index.showToast({icon:"error",title:`无${n[a]}订单`,duration:2e3}),!1;if(0==a){let n=k[a][0].id;e.index.navigateTo({url:"/pages/detail/unpaid?id="+n})}else e.index.navigateTo({url:"/pages/order/all?status="+a})};return(a,n)=>e.e({a:!i.value},i.value?{b:e.unref(t).avatar}:{},{c:i.value},i.value?{d:e.t(e.unref(t).nickname),e:e.o(y)}:{},{f:i.value},i.value?{g:e.o((e=>h("0"))),h:e.o((e=>h("2"))),i:e.o((e=>h("4"))),j:e.o((e=>h("all")))}:{},{k:i.value},i.value?{l:e.p({type:"right",size:"18",color:"#B3BAC5"}),m:e.o(x),n:e.p({type:"right",size:"18",color:"#B3BAC5"}),o:e.o(_),p:e.p({type:"right",size:"18",color:"#B3BAC5"}),q:e.o(w),r:e.p({type:"right",size:"18",color:"#B3BAC5"}),s:e.o((e=>r.value=!0))}:{},{t:!i.value},i.value?{}:{v:e.unref(c),w:e.o(v),x:e.o(p),y:e.o(g)},{z:i.value},i.value?{A:e.o(l)}:e.e({B:e.unref(c)},e.unref(c)?{C:e.o(d)}:{D:e.o(u)}),{E:e.p({active:"user"}),F:r.value},r.value?{G:e.o((e=>r.value=!1)),H:e.p({type:"closeempty",size:"30"}),I:e.o(s)}:{})}},o=e._export_sfc(t,[["__scopeId","data-v-77aa76e6"]]);wx.createPage(o);
