"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/api/index.js");Math||(n+i)();const n=()=>"../../components/header/index.js",i=()=>"../../components/DateElement.js",a={__name:"index",setup(n){let i=e.ref(!1),a=e.ref(!1),o=e.ref(!1),l=e.ref(!1),r=e.ref({name:"",phone:"",date:"",date_index:"",type:"2",number:""}),s=e.ref([{start_time:"06:00",end_time:"07:00",is_limit:0,index:"1",show:!1},{start_time:"07:00",end_time:"08:00",is_limit:0,index:"2",show:!1},{start_time:"08:00",end_time:"09:00",is_limit:0,index:"3",show:!1},{start_time:"09:00",end_time:"10:00",is_limit:0,index:"4",show:!1},{start_time:"10:00",end_time:"11:00",is_limit:0,index:"5",show:!1},{start_time:"11:00",end_time:"12:00",is_limit:0,index:"6",show:!1},{start_time:"12:00",end_time:"13:00",is_limit:0,index:"7",show:!1},{start_time:"13:00",end_time:"14:00",is_limit:0,index:"8",show:!1},{start_time:"14:00",end_time:"15:00",is_limit:0,index:"9",show:!1},{start_time:"15:00",end_time:"16:00",is_limit:0,index:"10",show:!1},{start_time:"16:00",end_time:"17:00",is_limit:0,index:"11",show:!1},{start_time:"17:00",end_time:"18:00",is_limit:0,index:"12",show:!1},{start_time:"18:00",end_time:"19:00",is_limit:0,index:"13",show:!1},{start_time:"19:00",end_time:"20:00",is_limit:0,index:"14",show:!1}]);const u=()=>{let e=r.value;Object.values(e).includes("")?d.value=!1:d.value=!0};let d=e.ref(!1);const m=()=>{if(a.value)return!1;i.value=!0},_=()=>{i.value=!1};let f=null;const v=(t,n)=>{let a=e.hooks(n).format("MM/DD");r.value.date_index=t.index,f={date:e.hooks(n).format("YYYY-MM-DD"),index:t.index};let o=`${a} ${t.start_time} `;r.value.date=o,i.value=!1,u()};let x=e.ref(1);const h=e=>{r.value.number=parseInt(e.detail.value)+1+"人",u()};e.ref([]);let p=e.ref(["1","2","3","4","5"]);const c=()=>{let e={name:r.value.name,phone:r.value.phone,date:f.date,date_index:f.index,type:"2",number:r.value.number.replace("人","")};t.CreateBookingPlans(e).then((e=>{l.value=!0,a.value=!0}))},w=()=>{t.CancelBookingPlans({type:2}).then((t=>{console.log(t),e.index.showToast({title:"操作成功，可再次在入口处预约时间",duration:2e3,icon:"none",success(){setTimeout((()=>{e.index.redirectTo({url:"/pages/index/index"})}),2e3)}}),r.value={name:"",phone:"",date:"",date_index:"",type:"2",number:""},a.value=!1}))};return e.onMounted((()=>{t.booking_order_detail({type:2}).then((t=>{console.log(t);try{if(0==parseInt(t.status)){a.value=!0,r.value.name=t.name,r.value.phone=t.phone,r.value.number=t.number+"人";let n=s.value.find((e=>e.index==t.time_index));f={date:t.booking_time,index:t.time_index};let i=`${e.hooks(t.booking_time).format("MM/DD")} ${n.start_time} `;r.value.date=i}else{a.value=!1;let t=e.index.getStorageSync("yy-phone");t&&(r.value.phone=t)}}catch(n){r.value={name:"",phone:"",date:"",date_index:"",type:"2",number:""},a.value=!1}}))})),(t,n)=>e.e({a:e.p({title:"科普馆预约"}),b:e.unref(a),c:e.o(u),d:e.unref(r).name,e:e.o((t=>e.unref(r).name=t.detail.value)),f:e.unref(a),g:e.o(u),h:e.unref(r).phone,i:e.o((t=>e.unref(r).phone=t.detail.value)),j:e.o(u),k:e.unref(r).date,l:e.o((t=>e.unref(r).date=t.detail.value)),m:e.o(m),n:e.o(u),o:e.unref(r).number,p:e.o((t=>e.unref(r).number=t.detail.value)),q:e.unref(x),r:e.unref(p),s:e.unref(a),t:e.o(h),v:!e.unref(a)},e.unref(a)?{y:e.o((t=>e.isRef(o)?o.value=!0:o=!0))}:e.e({w:e.unref(d)},e.unref(d)?{x:e.o(c)}:{}),{z:e.unref(i)},e.unref(i)?{A:e.o(v),B:e.o(_),C:e.p({type:"2"})}:{},{D:e.unref(l)},e.unref(l)?{E:e.o((t=>e.isRef(l)?l.value=!1:l=!1)),F:e.o((t=>e.isRef(l)?l.value=!1:l=!1))}:{},{G:e.unref(o)},e.unref(o)?{H:e.o((t=>e.isRef(o)?o.value=!1:o=!1)),I:e.o(w)}:{})}};wx.createPage(a);
