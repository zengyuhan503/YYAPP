"use strict";const e=require("../../common/vendor.js"),t=require("../../utils/api/index.js");Math||(n+i)();const n=()=>"../../components/header/index.js",i=()=>"../../components/DateElement.js",a={__name:"index2",setup(n){let i=e.ref(e.hooks().subtract(1,"months").format("YYYY-MM-DD")),a=e.ref(!1),o=e.ref(!1),l=e.ref(!1),r=e.ref(!1),s=e.ref({name:"",gender:"1",phone:"",date:"",date_index:"",age:"",birthday:"",type:"1"}),d=e.ref([{start_time:"06:00",end_time:"07:00",is_limit:0,index:"1",show:!1},{start_time:"07:00",end_time:"08:00",is_limit:0,index:"2",show:!1},{start_time:"08:00",end_time:"09:00",is_limit:0,index:"3",show:!1},{start_time:"09:00",end_time:"10:00",is_limit:0,index:"4",show:!1},{start_time:"10:00",end_time:"11:00",is_limit:0,index:"5",show:!1},{start_time:"11:00",end_time:"12:00",is_limit:0,index:"6",show:!1},{start_time:"12:00",end_time:"13:00",is_limit:0,index:"7",show:!1},{start_time:"13:00",end_time:"14:00",is_limit:0,index:"8",show:!1},{start_time:"14:00",end_time:"15:00",is_limit:0,index:"9",show:!1},{start_time:"15:00",end_time:"16:00",is_limit:0,index:"10",show:!1},{start_time:"16:00",end_time:"17:00",is_limit:0,index:"11",show:!1},{start_time:"17:00",end_time:"18:00",is_limit:0,index:"12",show:!1},{start_time:"18:00",end_time:"19:00",is_limit:0,index:"13",show:!1},{start_time:"19:00",end_time:"20:00",is_limit:0,index:"14",show:!1}]);const u=()=>{let e=s.value;Object.values(e).includes("")?m.value=!1:m.value=!0};let m=e.ref(!0);const _=()=>{if(o.value)return!1;a.value=!0},f=()=>{a.value=!1};let h=null;const v=(t,n)=>{let i=e.hooks(n).format("MM/DD");s.value.date_index=t.index,h={date:e.hooks(n).format("YYYY-MM-DD"),index:t.index};let o=`${i} ${t.start_time} `;s.value.date=o,a.value=!1,u()};let x=null,g=e.ref(1);const c=t=>{const n=e.hooks(t.detail.value);s.value.birthday=n.format("YYYY-MM-DD日");const i=e.hooks();let a=i.diff(n,"years"),o=i.diff(n,"months");0==a?(a="0."+o,s.value.age=o+"个月"):s.value.age=a+"岁",x=a,console.log(a),u()};e.ref([]);const p=()=>{let e={name:s.value.name,gender:s.value.gender,phone:s.value.phone,birthday:s.value.birthday,date:h.date,date_index:h.index,age:x,type:"1"};t.CreateBookingPlans(e).then((e=>{r.value=!0,o.value=!0}))},y=()=>{t.CancelBookingPlans({type:1}).then((t=>{console.log(t),e.index.showToast({title:"操作成功，可再次在入口处预约时间",duration:2e3,icon:"none",success(){setTimeout((()=>{e.index.redirectTo({url:"/pages/index/index"})}),2e3)}}),s.value={name:"",gender:"",phone:"",date:"",date_index:"",age:"",type:"",number:""},o.value=!1}))},w=e=>{if(o.value)return!1;s.value.gender=e};return e.onMounted((()=>{t.booking_order_detail({type:1}).then((t=>{console.log(t);try{if(0==t.status){s.value.name=t.name,s.value.phone=t.phone,s.value.gender=t.gender,s.value.birthday=t.birthday,s.value.age=t.age+"岁",x=t.age;let n=d.value.find((e=>e.index==t.time_index));h={date:t.booking_time,index:t.time_index};let i=`${e.hooks(t.booking_time).format("MM/DD")} ${n.start_time} `;s.value.date=i,o.value=!0}else{o.value=!1;let t=e.index.getStorageSync("yy-phone");t&&(s.value.phone=t)}u(),console.log(s.value)}catch(n){console.log(n)}}))})),(t,n)=>e.e({a:e.p({title:"看诊预约"}),b:e.unref(o),c:e.o(u),d:e.unref(s).name,e:e.o((t=>e.unref(s).name=t.detail.value)),f:e.unref(o),g:e.o(u),h:e.unref(s).phone,i:e.o((t=>e.unref(s).phone=t.detail.value)),j:1==e.unref(s).gender?1:"",k:e.o((e=>w("1"))),l:0==e.unref(s).gender?1:"",m:e.o((e=>w("0"))),n:e.o(u),o:e.unref(s).age,p:e.o((t=>e.unref(s).age=t.detail.value)),q:e.unref(i),r:e.unref(g),s:e.unref(o),t:e.o(c),v:e.o(u),w:e.unref(s).date,x:e.o((t=>e.unref(s).date=t.detail.value)),y:e.o(_),z:!e.unref(o)},e.unref(o)?{C:e.o((t=>e.isRef(l)?l.value=!0:l=!0))}:e.e({A:e.unref(m)},e.unref(m)?{B:e.o(p)}:{}),{D:e.unref(a)},e.unref(a)?{E:e.o(v),F:e.o(f),G:e.p({type:"1"})}:{},{H:e.unref(r)},e.unref(r)?{I:e.o((t=>e.isRef(r)?r.value=!1:r=!1)),J:e.o((t=>e.isRef(r)?r.value=!1:r=!1))}:{},{K:e.unref(l)},e.unref(l)?{L:e.o((t=>e.isRef(l)?l.value=!1:l=!1)),M:e.o(y)}:{})}};wx.createPage(a);
